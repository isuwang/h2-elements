<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="h2-button.html">
<!--

```javascript

<h2-image-view></h2-image-view>
```
-->

<dom-module id="h2-image-view">
  <template>
    <style>
      :host {
        display: flex;
        width: 150px;
        height: 180px;
        flex-flow: column nowrap;
        justify-content: stretch;
        align-items: stretch;
        text-align: center;
        border: 1px dashed #ccc;
        font-size: 12px;
        background: #f0f0f0;
      }

      .img__container {
        flex: 1;
        cursor: pointer;
        background-size: contain;
        background: no-repeat center;
      }

      .toolbar {
        display: flex;
        background: rgba(79, 79, 79, 0.33);
        border-top: 1px solid #ccc;
        height: 40px;
        justify-content: center;
        align-items: center;
        justify-self: flex-end;
      }

      .toolbar h2-button {
        height: 30px;
        --btn-primary-style: {
          background-color: #5cb85c;
        }
      }

      .img-viewer {
        display: flex;
        padding: 0;
        max-width: 100%;
        max-height: 100%;
      }

      .img-viewer > div {
        flex: 1;
      }

    </style>

    <div class="img__container" id="result-img" on-click="viewZoom"></div>

    <div class="toolbar">
      <h2-button on-click="viewZoom">查看大图</h2-button>
    </div>
    <paper-dialog class="img-viewer"
                  id="dialog"
                  on-click="closeDialog"
                  with-backdrop>
      <div src="[[src]]" id="viewContainer"></div>
    </paper-dialog>
  </template>
  <script>
    /**
     * `h2-image-view`
     *
     * @customElement
     * @polymer
     * @demo demo/h2-image-view/index.html
     */
    class H2ImageView extends Polymer.Element {
      static get properties() {
        return {
          src: {
            type: String,
            value: null,
            observer: '_changeSrc'
          },
        };
      }

      static get is() {
        return "h2-image-view";
      }

      _changeSrc(newValue) {
        if (newValue) {
          const style = this.$["result-img"].style;
          style.background = `url(${newValue}) no-repeat center`;
          style.backgroundSize = "contain";

          const style1 = this.$["viewContainer"].style;
          style1.background = `url(${newValue}) no-repeat center`;
          style1.backgroundSize = "contain";
        }
      }


      //查看大图
      viewZoom() {
        if (this.src) {
          this.$.dialog.open();
        }
      }

      closeDialog() {
        this.$.dialog.close();
      }

    }

    window.customElements.define(H2ImageView.is, H2ImageView);
  </script>
</dom-module>
