<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="h2-button.html">
<!--

```html

<h2-image-view src="https://test.com/test.jpg"></h2-image-view>
```
-->

<dom-module id="h2-image-view">
  <template>
    <style>
      :host {
        display: flex;
        width: 140px;
        height: 180px;
        flex-flow: column nowrap;
        text-align: center;
        border: 1px dashed #ccc;
        font-size: 12px;
        background: #f0f0f0;
      }

      .img__container {
        flex: 1;
        cursor: zoom-in;
        background-size: contain;
        background: no-repeat center;
      }

      .toolbar {
        display: flex;
        background: rgba(79, 79, 79, 0.33);
        height: 36px;
        justify-content: center;
        align-items: center;
        justify-self: flex-end;
      }

      .toolbar h2-button {
        height: 26px;
        --h2-button: {
          background-color: #5cb85c;
        }
      }

      .img__viewer {
        display: flex;
        overflow: auto;
      }

      .img__viewer > img {
        cursor: zoom-out;
        margin: 0;
        padding: 0;
      }

    </style>

    <div class="img__container" id="result-img" on-click="viewZoom"></div>

    <div class="toolbar">
      <h2-button on-click="viewZoom">查看大图</h2-button>
    </div>
    <paper-dialog class="img__viewer"
                  id="dialog"
                  on-click="closeDialog"
                  with-backdrop>
      <img src="[[src]]"/>
    </paper-dialog>
  </template>
  <script>
    /**
     * `h2-image-view`
     *
     * @customElement
     * @polymer
     * @demo demo/h2-image-view/index.html
     */
    class H2ImageView extends Polymer.Element {
      static get properties() {
        return {
          src: {
            type: String,
            value: null,
            observer: '_changeSrc'
          },
        };
      }

      static get is() {
        return "h2-image-view";
      }

      _changeSrc(newValue) {
        if (newValue) {
          const style = this.$["result-img"].style;
          style.background = `url(${newValue}) no-repeat center`;
          style.backgroundSize = "contain";
        }
      }


      //查看大图
      viewZoom() {
        if (this.src) {
          this.$.dialog.open();
        }
      }

      closeDialog() {
        this.$.dialog.close();
      }

    }

    window.customElements.define(H2ImageView.is, H2ImageView);
  </script>
</dom-module>
