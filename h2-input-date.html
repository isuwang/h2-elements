<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-input/paper-input.html">

<!--

```javascript

<h2-input-date></h2-input-date>
```
-->

<dom-module id="h2-input-date">
    <template>
        <style>
            :host {
                --paper-input-container: {
                    padding: 0px 0px;
                }
            }
        </style>
        <paper-input
                id="input"
                no-label-float="true"
                always-float-label="false"
                value="{{value}}"
                label=[[label]]
                placeholder="[[label]]"
                auto-validate
                required=[[required]]
                error-message="[[prompt]]"
                min="[[min]]"
                max="[[max]]"
                pattern="[[pattern]]"
                readonly="[[readonly]]"
                type="date">
        </paper-input>
    </template>
    <script>
        /**
         * `h2-input-date`
         *
         * @customElement
         * @polymer
         * @demo demo/h2-input-date/index.html
         */
        class H2InputDate extends Polymer.Element {
            static get properties() {
                return {
                    /**
                     * 组件返回的时间字符串，默认格式yyyy-MM-dd
                     */
                    value: {
                        type: String,
                        notify: true,
                        observer: "_valueChange"
                    },
                    /**
                     * 根据时间字符串返回的时间戳,long型
                     */
                    time: {
                        type: Number,
                        notify: true,
                        observer:"_timeChange"
                    },
                    /**
                     * 组件标签名
                     */
                    label: {
                        type: String
                    },
                    /**
                     * 是否必填
                     */
                    required: {
                        type: Boolean
                    },
                    /**
                     * 校验正则
                     */
                    pattern: {
                        type: String
                    },
                    /**
                     * 正则校验错误的提示语
                     */
                    prompt: {
                        type: String
                    },
                    /**
                     * 最小输入值(数字或日期时间)
                     */
                    min: {
                        type: String
                    },
                    /**
                     * 最大输入值(数字或日期时间)
                     */
                    max: {
                        type: String
                    },
                    /**
                     * 是否只读
                     */
                    readonly: {
                        type: Boolean
                    }
                };
            }

            static get is() {
                return "h2-input-date";
            }

            _valueChange(value) {
                if (!value) {
                    this.set("time", undefined);
                    return;
                }
                let time = new Date(value).getTime();
                this.set("time", time);
            }

            _timeChange(time){
                if(!value){
                    this.set("value","");
                    return;
                }
                let date = new Date(time);
                let value = date.toJSON().substr(0,date.toJSON().indexOf('T'));
                this.set("value",value);
            }
        }
        window.customElements.define(H2InputDate.is, H2InputDate);
    </script>
</dom-module>
